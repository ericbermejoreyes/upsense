FROM node:14.15.4-slim

EXPOSE 1883
EXPOSE 1884

WORKDIR /var/www

RUN mkdir certificates

COPY ./certificates/ /var/www/certificates

ADD ./.env /var/www

RUN mkdir mqtt_broker

COPY ./mqtt/package.json /var/www/mqtt_broker

COPY ./mqtt/ /var/www/mqtt_broker

WORKDIR /var/www/mqtt_broker

RUN npm install

CMD ["npm", "run", "dev"]
