version: '3'

services:
    app:
        # Upsense web app
        container_name: upsense_app
        build:
            context: ./
            dockerfile: docker/development/app.dockerfile
        image: upsense_app:latest
        volumes:
            - ./storage:/var/www/storage
        env_file: '.env.dev'
        environment:
            - "DB_HOST=upsense"
            
    # nginx web server
    web:
        container_name: upsense_nginx
        image: upsense_web:latest
        build:
            context: ./
            dockerfile: docker/development/web.dockerfile
        volumes:
            - ./storage/logs/:/var/log/nginx
            - ./:/var/www/html
        working_dir: /var/www/html

        ports:
            - 8990:80
            # - 443:443

volumes:
    dbdata:
        # driver: local

